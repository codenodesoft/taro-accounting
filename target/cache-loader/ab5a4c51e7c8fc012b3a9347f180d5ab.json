{"remainingRequest":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\thread-loader\\dist\\cjs.js??ref--9-2!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\ts-loader\\index.js??ref--9-3!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\angular-router-loader\\src\\index.js!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\tslint-loader\\index.js!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\src\\main\\webapp\\app\\entities\\requisition-extended\\requisition-extended-update.component.ts","dependencies":[{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\src\\main\\webapp\\app\\entities\\requisition-extended\\requisition-extended-update.component.ts","mtime":1625565387681},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\angular2-template-loader\\index.js","mtime":1486570058000},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\ts-loader\\index.js","mtime":1545640398000},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\angular-router-loader\\src\\index.js","mtime":1512749902000},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\tslint-loader\\index.js","mtime":1519899048000}],"contextDependencies":[],"result":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\nvar core_1 = require(\"@angular/core\");\r\nvar router_1 = require(\"@angular/router\");\r\nvar operators_1 = require(\"rxjs/operators\");\r\nvar moment = require(\"moment\");\r\nvar ng_jhipster_1 = require(\"ng-jhipster\");\r\nvar requisition_model_1 = require(\"app/shared/model/requisition.model\");\r\nvar employee_1 = require(\"app/entities/employee\");\r\nvar office_1 = require(\"app/entities/office\");\r\nvar product_category_1 = require(\"app/entities/product-category\");\r\nvar department_1 = require(\"app/entities/department\");\r\nvar core_2 = require(\"app/core\");\r\nvar purchase_order_1 = require(\"app/entities/purchase-order\");\r\nvar purchase_order_model_1 = require(\"app/shared/model/purchase-order.model\");\r\nvar requisition_1 = require(\"app/entities/requisition\");\r\nvar ng_bootstrap_1 = require(\"@ng-bootstrap/ng-bootstrap\");\r\nvar requisition_details_1 = require(\"app/entities/requisition-details\");\r\nvar quotation_1 = require(\"app/entities/quotation\");\r\nvar rxjs_1 = require(\"rxjs\");\r\nvar forms_1 = require(\"@angular/forms\");\r\nvar requisition_extended_service_1 = require(\"app/entities/requisition-extended/requisition-extended.service\");\r\nvar commercial_budget_1 = require(\"app/entities/commercial-budget\");\r\nvar commercial_product_info_1 = require(\"app/entities/commercial-product-info\");\r\nvar RequisitionExtendedUpdateComponent = /** @class */ (function (_super) {\r\n    tslib_1.__extends(RequisitionExtendedUpdateComponent, _super);\r\n    function RequisitionExtendedUpdateComponent(dataUtils, jhiAlertService, requisitionService, employeeService, officeService, productCategoryService, departmentService, activatedRoute, accountService, purchaseOrderService, modalService, requisitionDetailsService, quotationService, eventManager, router, commercialBudgetService, commercialProductInfoService) {\r\n        var _this = _super.call(this, dataUtils, jhiAlertService, requisitionService, employeeService, officeService, productCategoryService, departmentService, activatedRoute) || this;\r\n        _this.dataUtils = dataUtils;\r\n        _this.jhiAlertService = jhiAlertService;\r\n        _this.requisitionService = requisitionService;\r\n        _this.employeeService = employeeService;\r\n        _this.officeService = officeService;\r\n        _this.productCategoryService = productCategoryService;\r\n        _this.departmentService = departmentService;\r\n        _this.activatedRoute = activatedRoute;\r\n        _this.accountService = accountService;\r\n        _this.purchaseOrderService = purchaseOrderService;\r\n        _this.modalService = modalService;\r\n        _this.requisitionDetailsService = requisitionDetailsService;\r\n        _this.quotationService = quotationService;\r\n        _this.eventManager = eventManager;\r\n        _this.router = router;\r\n        _this.commercialBudgetService = commercialBudgetService;\r\n        _this.commercialProductInfoService = commercialProductInfoService;\r\n        _this.focus$ = new rxjs_1.Subject();\r\n        _this.click$ = new rxjs_1.Subject();\r\n        _this.search = function (text$) {\r\n            var debouncedText$ = text$.pipe(operators_1.debounceTime(200), operators_1.distinctUntilChanged());\r\n            var clicksWithClosedPopup$ = _this.click$.pipe(operators_1.filter(function () { return !_this.instance.isPopupOpen(); }));\r\n            var inputFocus$ = _this.focus$;\r\n            return rxjs_1.merge(debouncedText$, inputFocus$, clicksWithClosedPopup$).pipe(operators_1.map(function (term) {\r\n                return (term === ''\r\n                    ? _this.productCategoryNameList\r\n                    : _this.productCategoryNameList.filter(function (v) { return v.toLowerCase().indexOf(term.toLowerCase()) > -1; })).slice(0, 10);\r\n            }));\r\n        };\r\n        return _this;\r\n    }\r\n    RequisitionExtendedUpdateComponent.prototype.ngOnInit = function () {\r\n        var _this = this;\r\n        this.accountService.identity().then(function (account) {\r\n            _this.currentAccount = account;\r\n            _this.employeeService\r\n                .query({\r\n                'employeeId.equals': _this.currentAccount.login\r\n            })\r\n                .subscribe(function (res) {\r\n                _this.currentEmployee = res.body[0];\r\n                if (!_this.requisition.employeeId) {\r\n                    _this.requisition.employeeId = res.body[0].id;\r\n                }\r\n                if (!_this.requisition.departmentId) {\r\n                    _this.requisition.departmentId = res.body[0].departmentId;\r\n                }\r\n                if (!_this.requisition.officeId) {\r\n                    _this.requisition.officeId = res.body[0].officeId;\r\n                }\r\n            }, function (res) { return _this.onError(res.message); });\r\n        });\r\n        this.isSaving = false;\r\n        this.activatedRoute.data.subscribe(function (_a) {\r\n            var requisition = _a.requisition;\r\n            _this.requisition = requisition;\r\n            _this.selectedProductCategory = _this.requisition.productCategoryName;\r\n            _this.generateRequisitionNo();\r\n        });\r\n        this.officeService\r\n            .query()\r\n            .pipe(operators_1.filter(function (mayBeOk) { return mayBeOk.ok; }), operators_1.map(function (response) { return response.body; }))\r\n            .subscribe(function (res) { return (_this.offices = res); }, function (res) { return _this.onError(res.message); });\r\n        this.productCategoryService\r\n            .query()\r\n            .pipe(operators_1.filter(function (mayBeOk) { return mayBeOk.ok; }), operators_1.map(function (response) { return response.body; }))\r\n            .subscribe(function (res) {\r\n            _this.productcategories = res;\r\n            _this.productCategoryNameMapId = {};\r\n            _this.productCategoryNameList = [];\r\n            _this.productCategoryIdMapName = {};\r\n            _this.productcategories.forEach(function (p) {\r\n                _this.productCategoryNameMapId[p.name] = p.id;\r\n                _this.productCategoryIdMapName[p.id] = p.name;\r\n                _this.productCategoryNameList.push(p.name);\r\n            });\r\n        }, function (res) { return _this.onError(res.message); });\r\n        if (this.requisition.productCategoryId) {\r\n            this.productCategoryService.find(this.requisition.productCategoryId).subscribe(function (res) {\r\n                _this.productCategory = res.body;\r\n            });\r\n        }\r\n        this.departmentService\r\n            .query()\r\n            .pipe(operators_1.filter(function (mayBeOk) { return mayBeOk.ok; }), operators_1.map(function (response) { return response.body; }))\r\n            .subscribe(function (res) { return (_this.departments = res); }, function (res) { return _this.onError(res.message); });\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.filterProductCategories = function (event) {\r\n        var _this = this;\r\n        this.productCategoryService\r\n            .query({\r\n            'name.contains': event.query.toString()\r\n        })\r\n            .subscribe(function (res) {\r\n            _this.productcategories = [];\r\n            _this.productcategories = res.body;\r\n        });\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.disableOrEnableComponents = function () {\r\n        var _this = this;\r\n        if ((this.requisition.status == requisition_model_1.RequisitionStatus.MODIFICATION_REQUEST_BY_CFO ||\r\n            this.requisition.status == requisition_model_1.RequisitionStatus.MODIFICATION_REQUEST_BY_PURCHASE_COMMITTEE ||\r\n            this.requisition.status == null ||\r\n            this.requisition.status == undefined) &&\r\n            this.currentAccount.authorities.includes('ROLE_REQUISITION')) {\r\n            setTimeout(function () {\r\n                _this.editForm.form.enable();\r\n            }, 500);\r\n        }\r\n        else {\r\n            setTimeout(function () {\r\n                _this.editForm.form.disable();\r\n            }, 500);\r\n        }\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.generateRequisitionNo = function () {\r\n        var _this = this;\r\n        if (!this.requisition.requisitionNo) {\r\n            var dateStrFrom = new Date().getFullYear() + '-01-01';\r\n            var dateFrom = moment(dateStrFrom, 'DD-MM-YYYY').toDate();\r\n            var dateStrTo = new Date().getFullYear() + '-12-31';\r\n            var dateTo = moment(dateStrTo, 'DD-MM-YYYY').toDate();\r\n            this.requisitionService\r\n                .query({\r\n                'requisitionDate.greaterOrEqualThan': dateStrFrom,\r\n                'requisitionDate.lessOrEqualThan': dateStrTo\r\n            })\r\n                .subscribe(function (res) {\r\n                var dateStr = moment(new Date()).format('DD-MM-YYYY');\r\n                _this.requisition.requisitionNo = 'SOFPL-PR-' + dateStr + '-' + _this.zeroPad(res.body.length + 1, 5);\r\n            });\r\n        }\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.zeroPad = function (num, places) {\r\n        var zero = places - num.toString().length + 1;\r\n        return Array(+(zero > 0 && zero)).join('0') + num;\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.save = function () {\r\n        this.isSaving = true;\r\n        this.requisition.productCategoryId = this.productCategoryNameMapId[this.selectedProductCategory];\r\n        if (this.requisition.id !== undefined) {\r\n            this.subscribeToSaveResponse(this.requisitionService.update(this.requisition));\r\n        }\r\n        else {\r\n            this.subscribeToSaveResponse(this.requisitionService.create(this.requisition));\r\n        }\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.subscribeToSaveResponse = function (result) {\r\n        var _this = this;\r\n        result.subscribe(function (rZes) {\r\n            _this.requisition = rZes.body;\r\n            _this.isSaving = false;\r\n            _this.router.navigate(['/requisition', _this.requisition.id, 'edit']);\r\n        }, function (res) { return _this.onSaveError(); });\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.forwardToHead = function () {\r\n        this.requisition.status = requisition_model_1.RequisitionStatus.WAITING_FOR_HEADS_APPROVAL;\r\n        this.save();\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.approveByHead = function () {\r\n        this.requisition.status = requisition_model_1.RequisitionStatus.FORWARDED_BY_HEAD;\r\n        this.save();\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.rejectByHead = function () {\r\n        this.requisition.status = requisition_model_1.RequisitionStatus.REJECTED_BY_HEAD;\r\n        this.save();\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.approveByPurchaseCommittee = function () {\r\n        this.requisition.status = requisition_model_1.RequisitionStatus.FORWARDED_BY_PURCHASE_COMMITTEE;\r\n        //this.requisition.refToPurchaseCommittee = this.currentEmployee.id;\r\n        this.save();\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.rejectByPurchaseCommittee = function () {\r\n        this.requisition.status = requisition_model_1.RequisitionStatus.REJECTED_BY_PURCHASE_COMMITTEE;\r\n        //this.requisition.refToPurchaseCommittee = this.currentEmployee.id;\r\n        this.save();\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.approveByCFO = function () {\r\n        this.requisition.status = requisition_model_1.RequisitionStatus.APPROVED_BY_CFO;\r\n        //this.requisition.refToPurchaseCommittee = this.currentEmployee.id;\r\n        this.save();\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.rejectByCFO = function () {\r\n        this.requisition.status = requisition_model_1.RequisitionStatus.REJECTED_BY_CFO;\r\n        //this.requisition.refToPurchaseCommittee = this.currentEmployee.id;\r\n        this.save();\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.receivedByRequester = function () {\r\n        this.requisition.status = requisition_model_1.RequisitionStatus.RECEIVED_BY_REQUISIONER;\r\n        this.save();\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.receivedAndVerifiedByHead = function () {\r\n        this.requisition.status = requisition_model_1.RequisitionStatus.RECEIVED_VERIFIED_BY_HEAD;\r\n        this.save();\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.closedByCFO = function () {\r\n        var _this = this;\r\n        this.purchaseOrderService\r\n            .query({\r\n            'requisitionId.equals': this.requisition.id\r\n        })\r\n            .subscribe(function (res) {\r\n            var purchaseOrder = res.body[0];\r\n            purchaseOrder.status = purchase_order_model_1.PurchaseOrderStatus.CLOSED_BY_CFO;\r\n            _this.purchaseOrderService.update(purchaseOrder);\r\n            _this.requisition.status = requisition_model_1.RequisitionStatus.CLOSED_BY_CFO;\r\n            _this.save();\r\n        });\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.createPurchaseOrder = function () {\r\n        var requisitionId = this.requisition.id;\r\n        this.router.navigate(['/purchase-order', requisitionId, 'create']);\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.onError = function (errorMessage) {\r\n        this.jhiAlertService.error(errorMessage, null, null);\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.trackEmployeeById = function (index, item) {\r\n        return item.id;\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.trackOfficeById = function (index, item) {\r\n        return item.id;\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.trackProductCategoryById = function (index, item) {\r\n        return item.id;\r\n    };\r\n    RequisitionExtendedUpdateComponent.prototype.trackDepartmentById = function (index, item) {\r\n        return item.id;\r\n    };\r\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u;\r\n    tslib_1.__decorate([\r\n        core_1.ViewChild('instance'),\r\n        tslib_1.__metadata(\"design:type\", typeof (_a = typeof ng_bootstrap_1.NgbTypeahead !== \"undefined\" && ng_bootstrap_1.NgbTypeahead) === \"function\" ? _a : Object)\r\n    ], RequisitionExtendedUpdateComponent.prototype, \"instance\", void 0);\r\n    tslib_1.__decorate([\r\n        core_1.ViewChild('editForm'),\r\n        tslib_1.__metadata(\"design:type\", typeof (_b = typeof forms_1.NgForm !== \"undefined\" && forms_1.NgForm) === \"function\" ? _b : Object)\r\n    ], RequisitionExtendedUpdateComponent.prototype, \"editForm\", void 0);\r\n    RequisitionExtendedUpdateComponent = tslib_1.__decorate([\r\n        core_1.Component({\r\n            selector: 'jhi-requisition-extended-update',\r\n            templateUrl: './requisition-extended-update.component.html'\r\n        }),\r\n        tslib_1.__metadata(\"design:paramtypes\", [typeof (_c = typeof ng_jhipster_1.JhiDataUtils !== \"undefined\" && ng_jhipster_1.JhiDataUtils) === \"function\" ? _c : Object, typeof (_d = typeof ng_jhipster_1.JhiAlertService !== \"undefined\" && ng_jhipster_1.JhiAlertService) === \"function\" ? _d : Object, typeof (_e = typeof requisition_extended_service_1.RequisitionExtendedService !== \"undefined\" && requisition_extended_service_1.RequisitionExtendedService) === \"function\" ? _e : Object, typeof (_f = typeof employee_1.EmployeeService !== \"undefined\" && employee_1.EmployeeService) === \"function\" ? _f : Object, typeof (_g = typeof office_1.OfficeService !== \"undefined\" && office_1.OfficeService) === \"function\" ? _g : Object, typeof (_h = typeof product_category_1.ProductCategoryService !== \"undefined\" && product_category_1.ProductCategoryService) === \"function\" ? _h : Object, typeof (_j = typeof department_1.DepartmentService !== \"undefined\" && department_1.DepartmentService) === \"function\" ? _j : Object, typeof (_k = typeof router_1.ActivatedRoute !== \"undefined\" && router_1.ActivatedRoute) === \"function\" ? _k : Object, typeof (_l = typeof core_2.AccountService !== \"undefined\" && core_2.AccountService) === \"function\" ? _l : Object, typeof (_m = typeof purchase_order_1.PurchaseOrderService !== \"undefined\" && purchase_order_1.PurchaseOrderService) === \"function\" ? _m : Object, typeof (_o = typeof ng_bootstrap_1.NgbModal !== \"undefined\" && ng_bootstrap_1.NgbModal) === \"function\" ? _o : Object, typeof (_p = typeof requisition_details_1.RequisitionDetailsService !== \"undefined\" && requisition_details_1.RequisitionDetailsService) === \"function\" ? _p : Object, typeof (_q = typeof quotation_1.QuotationService !== \"undefined\" && quotation_1.QuotationService) === \"function\" ? _q : Object, typeof (_r = typeof ng_jhipster_1.JhiEventManager !== \"undefined\" && ng_jhipster_1.JhiEventManager) === \"function\" ? _r : Object, typeof (_s = typeof router_1.Router !== \"undefined\" && router_1.Router) === \"function\" ? _s : Object, typeof (_t = typeof commercial_budget_1.CommercialBudgetService !== \"undefined\" && commercial_budget_1.CommercialBudgetService) === \"function\" ? _t : Object, typeof (_u = typeof commercial_product_info_1.CommercialProductInfoService !== \"undefined\" && commercial_product_info_1.CommercialProductInfoService) === \"function\" ? _u : Object])\r\n    ], RequisitionExtendedUpdateComponent);\r\n    return RequisitionExtendedUpdateComponent;\r\n}(requisition_1.RequisitionUpdateComponent));\r\nexports.RequisitionExtendedUpdateComponent = RequisitionExtendedUpdateComponent;\r\n",{"version":3,"file":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\src\\main\\webapp\\app\\entities\\requisition-extended\\requisition-extended-update.component.ts","sourceRoot":"","sources":["C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\angular-router-loader\\src\\index.js!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\tslint-loader\\index.js!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\src\\main\\webapp\\app\\entities\\requisition-extended\\requisition-extended-update.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { HttpErrorResponse, HttpResponse } from '@angular/common/http';\r\nimport { debounceTime, distinctUntilChanged, filter, map } from 'rxjs/operators';\r\nimport * as moment from 'moment';\r\nimport { JhiAlertService, JhiDataUtils, JhiEventManager } from 'ng-jhipster';\r\nimport { IRequisition, RequisitionStatus } from 'app/shared/model/requisition.model';\r\nimport { IEmployee } from 'app/shared/model/employee.model';\r\nimport { EmployeeService } from 'app/entities/employee';\r\nimport { IOffice } from 'app/shared/model/office.model';\r\nimport { OfficeService } from 'app/entities/office';\r\nimport { IProductCategory } from 'app/shared/model/product-category.model';\r\nimport { ProductCategoryService } from 'app/entities/product-category';\r\nimport { IDepartment } from 'app/shared/model/department.model';\r\nimport { DepartmentService } from 'app/entities/department';\r\nimport { AccountService } from 'app/core';\r\nimport { PurchaseOrderService } from 'app/entities/purchase-order';\r\nimport { IPurchaseOrder, PurchaseOrderStatus } from 'app/shared/model/purchase-order.model';\r\nimport { RequisitionUpdateComponent } from 'app/entities/requisition';\r\nimport { NgbModal, NgbTypeahead } from '@ng-bootstrap/ng-bootstrap';\r\nimport { RequisitionDetailsService } from 'app/entities/requisition-details';\r\nimport { QuotationService } from 'app/entities/quotation';\r\nimport { merge, Observable, Subject } from 'rxjs';\r\nimport { NgForm } from '@angular/forms';\r\nimport { RequisitionExtendedService } from 'app/entities/requisition-extended/requisition-extended.service';\r\nimport { CommercialBudgetService } from 'app/entities/commercial-budget';\r\nimport { CommercialProductInfoService } from 'app/entities/commercial-product-info';\r\nimport { ICommercialBudget } from 'app/shared/model/commercial-budget.model';\r\nimport { ICommercialProductInfo } from 'app/shared/model/commercial-product-info.model';\r\n\r\n@Component({\r\n    selector: 'jhi-requisition-extended-update',\r\n    templateUrl: './requisition-extended-update.component.html'\r\n})\r\nexport class RequisitionExtendedUpdateComponent extends RequisitionUpdateComponent implements OnInit {\r\n    currentAccount: any;\r\n    currentEmployee: IEmployee;\r\n\r\n    employees: IEmployee[];\r\n\r\n    offices: IOffice[];\r\n\r\n    commercialBudget: ICommercialBudget;\r\n    commercialProductInfos: ICommercialProductInfo[];\r\n\r\n    productcategories: IProductCategory[];\r\n    productCategory: IProductCategory;\r\n    selectedProductCategory: string;\r\n    productCategoryNameMapId: any;\r\n    productCategoryNameList: string[];\r\n    productCategoryIdMapName: any;\r\n\r\n    @ViewChild('instance') instance: NgbTypeahead;\r\n    @ViewChild('editForm') editForm: NgForm;\r\n\r\n    focus$ = new Subject<string>();\r\n    click$ = new Subject<string>();\r\n\r\n    constructor(\r\n        protected dataUtils: JhiDataUtils,\r\n        protected jhiAlertService: JhiAlertService,\r\n        protected requisitionService: RequisitionExtendedService,\r\n        protected employeeService: EmployeeService,\r\n        protected officeService: OfficeService,\r\n        protected productCategoryService: ProductCategoryService,\r\n        protected departmentService: DepartmentService,\r\n        protected activatedRoute: ActivatedRoute,\r\n        public accountService: AccountService,\r\n        protected purchaseOrderService: PurchaseOrderService,\r\n        public modalService: NgbModal,\r\n        protected requisitionDetailsService: RequisitionDetailsService,\r\n        protected quotationService: QuotationService,\r\n        protected eventManager: JhiEventManager,\r\n        protected router: Router,\r\n        private commercialBudgetService: CommercialBudgetService,\r\n        private commercialProductInfoService: CommercialProductInfoService\r\n    ) {\r\n        super(\r\n            dataUtils,\r\n            jhiAlertService,\r\n            requisitionService,\r\n            employeeService,\r\n            officeService,\r\n            productCategoryService,\r\n            departmentService,\r\n            activatedRoute\r\n        );\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.accountService.identity().then(account => {\r\n            this.currentAccount = account;\r\n            this.employeeService\r\n                .query({\r\n                    'employeeId.equals': this.currentAccount.login\r\n                })\r\n                .subscribe(\r\n                    (res: HttpResponse<IEmployee[]>) => {\r\n                        this.currentEmployee = res.body[0];\r\n                        if (!this.requisition.employeeId) {\r\n                            this.requisition.employeeId = res.body[0].id;\r\n                        }\r\n                        if (!this.requisition.departmentId) {\r\n                            this.requisition.departmentId = res.body[0].departmentId;\r\n                        }\r\n                        if (!this.requisition.officeId) {\r\n                            this.requisition.officeId = res.body[0].officeId;\r\n                        }\r\n                    },\r\n                    (res: HttpErrorResponse) => this.onError(res.message)\r\n                );\r\n        });\r\n\r\n        this.isSaving = false;\r\n        this.activatedRoute.data.subscribe(({ requisition }) => {\r\n            this.requisition = requisition;\r\n            this.selectedProductCategory = this.requisition.productCategoryName;\r\n            this.generateRequisitionNo();\r\n        });\r\n\r\n        this.officeService\r\n            .query()\r\n            .pipe(\r\n                filter((mayBeOk: HttpResponse<IOffice[]>) => mayBeOk.ok),\r\n                map((response: HttpResponse<IOffice[]>) => response.body)\r\n            )\r\n            .subscribe((res: IOffice[]) => (this.offices = res), (res: HttpErrorResponse) => this.onError(res.message));\r\n        this.productCategoryService\r\n            .query()\r\n            .pipe(\r\n                filter((mayBeOk: HttpResponse<IProductCategory[]>) => mayBeOk.ok),\r\n                map((response: HttpResponse<IProductCategory[]>) => response.body)\r\n            )\r\n            .subscribe(\r\n                (res: IProductCategory[]) => {\r\n                    this.productcategories = res;\r\n                    this.productCategoryNameMapId = {};\r\n                    this.productCategoryNameList = [];\r\n                    this.productCategoryIdMapName = {};\r\n                    this.productcategories.forEach((p: IProductCategory) => {\r\n                        this.productCategoryNameMapId[p.name] = p.id;\r\n                        this.productCategoryIdMapName[p.id] = p.name;\r\n                        this.productCategoryNameList.push(p.name);\r\n                    });\r\n                },\r\n\r\n                (res: HttpErrorResponse) => this.onError(res.message)\r\n            );\r\n\r\n        if (this.requisition.productCategoryId) {\r\n            this.productCategoryService.find(this.requisition.productCategoryId).subscribe((res: HttpResponse<IProductCategory>) => {\r\n                this.productCategory = res.body;\r\n            });\r\n        }\r\n        this.departmentService\r\n            .query()\r\n            .pipe(\r\n                filter((mayBeOk: HttpResponse<IDepartment[]>) => mayBeOk.ok),\r\n                map((response: HttpResponse<IDepartment[]>) => response.body)\r\n            )\r\n            .subscribe((res: IDepartment[]) => (this.departments = res), (res: HttpErrorResponse) => this.onError(res.message));\r\n    }\r\n\r\n    filterProductCategories(event) {\r\n        this.productCategoryService\r\n            .query({\r\n                'name.contains': event.query.toString()\r\n            })\r\n            .subscribe((res: HttpResponse<IProductCategory[]>) => {\r\n                this.productcategories = [];\r\n                this.productcategories = res.body;\r\n            });\r\n    }\r\n\r\n    disableOrEnableComponents() {\r\n        if (\r\n            (this.requisition.status == RequisitionStatus.MODIFICATION_REQUEST_BY_CFO ||\r\n                this.requisition.status == RequisitionStatus.MODIFICATION_REQUEST_BY_PURCHASE_COMMITTEE ||\r\n                this.requisition.status == null ||\r\n                this.requisition.status == undefined) &&\r\n            this.currentAccount.authorities.includes('ROLE_REQUISITION')\r\n        ) {\r\n            setTimeout(() => {\r\n                this.editForm.form.enable();\r\n            }, 500);\r\n        } else {\r\n            setTimeout(() => {\r\n                this.editForm.form.disable();\r\n            }, 500);\r\n        }\r\n    }\r\n\r\n    generateRequisitionNo() {\r\n        if (!this.requisition.requisitionNo) {\r\n            const dateStrFrom = new Date().getFullYear() + '-01-01';\r\n            const dateFrom: Date = moment(dateStrFrom, 'DD-MM-YYYY').toDate();\r\n            const dateStrTo = new Date().getFullYear() + '-12-31';\r\n            const dateTo: Date = moment(dateStrTo, 'DD-MM-YYYY').toDate();\r\n            this.requisitionService\r\n                .query({\r\n                    'requisitionDate.greaterOrEqualThan': dateStrFrom,\r\n                    'requisitionDate.lessOrEqualThan': dateStrTo\r\n                })\r\n                .subscribe((res: HttpResponse<IRequisition[]>) => {\r\n                    const dateStr = moment(new Date()).format('DD-MM-YYYY');\r\n                    this.requisition.requisitionNo = 'SOFPL-PR-' + dateStr + '-' + this.zeroPad(res.body.length + 1, 5);\r\n                });\r\n        }\r\n    }\r\n\r\n    zeroPad(num, places): string {\r\n        const zero = places - num.toString().length + 1;\r\n        return Array(+(zero > 0 && zero)).join('0') + num;\r\n    }\r\n\r\n    save() {\r\n        this.isSaving = true;\r\n        this.requisition.productCategoryId = this.productCategoryNameMapId[this.selectedProductCategory];\r\n        if (this.requisition.id !== undefined) {\r\n            this.subscribeToSaveResponse(this.requisitionService.update(this.requisition));\r\n        } else {\r\n            this.subscribeToSaveResponse(this.requisitionService.create(this.requisition));\r\n        }\r\n    }\r\n\r\n    protected subscribeToSaveResponse(result: Observable<HttpResponse<IRequisition>>) {\r\n        result.subscribe(\r\n            (rZes: HttpResponse<IRequisition>) => {\r\n                this.requisition = rZes.body;\r\n                this.isSaving = false;\r\n                this.router.navigate(['/requisition', this.requisition.id, 'edit']);\r\n            },\r\n            (res: HttpErrorResponse) => this.onSaveError()\r\n        );\r\n    }\r\n\r\n    forwardToHead() {\r\n        this.requisition.status = RequisitionStatus.WAITING_FOR_HEADS_APPROVAL;\r\n        this.save();\r\n    }\r\n\r\n    approveByHead() {\r\n        this.requisition.status = RequisitionStatus.FORWARDED_BY_HEAD;\r\n        this.save();\r\n    }\r\n    rejectByHead() {\r\n        this.requisition.status = RequisitionStatus.REJECTED_BY_HEAD;\r\n        this.save();\r\n    }\r\n    approveByPurchaseCommittee() {\r\n        this.requisition.status = RequisitionStatus.FORWARDED_BY_PURCHASE_COMMITTEE;\r\n        //this.requisition.refToPurchaseCommittee = this.currentEmployee.id;\r\n        this.save();\r\n    }\r\n    rejectByPurchaseCommittee() {\r\n        this.requisition.status = RequisitionStatus.REJECTED_BY_PURCHASE_COMMITTEE;\r\n        //this.requisition.refToPurchaseCommittee = this.currentEmployee.id;\r\n        this.save();\r\n    }\r\n\r\n    approveByCFO() {\r\n        this.requisition.status = RequisitionStatus.APPROVED_BY_CFO;\r\n        //this.requisition.refToPurchaseCommittee = this.currentEmployee.id;\r\n        this.save();\r\n    }\r\n    rejectByCFO() {\r\n        this.requisition.status = RequisitionStatus.REJECTED_BY_CFO;\r\n        //this.requisition.refToPurchaseCommittee = this.currentEmployee.id;\r\n        this.save();\r\n    }\r\n\r\n    receivedByRequester() {\r\n        this.requisition.status = RequisitionStatus.RECEIVED_BY_REQUISIONER;\r\n        this.save();\r\n    }\r\n\r\n    receivedAndVerifiedByHead() {\r\n        this.requisition.status = RequisitionStatus.RECEIVED_VERIFIED_BY_HEAD;\r\n        this.save();\r\n    }\r\n\r\n    closedByCFO() {\r\n        this.purchaseOrderService\r\n            .query({\r\n                'requisitionId.equals': this.requisition.id\r\n            })\r\n            .subscribe((res: HttpResponse<IPurchaseOrder[]>) => {\r\n                const purchaseOrder = res.body[0];\r\n                purchaseOrder.status = PurchaseOrderStatus.CLOSED_BY_CFO;\r\n                this.purchaseOrderService.update(purchaseOrder);\r\n\r\n                this.requisition.status = RequisitionStatus.CLOSED_BY_CFO;\r\n                this.save();\r\n            });\r\n    }\r\n\r\n    public createPurchaseOrder(): void {\r\n        const requisitionId = this.requisition.id;\r\n        this.router.navigate(['/purchase-order', requisitionId, 'create']);\r\n    }\r\n\r\n    protected onError(errorMessage: string) {\r\n        this.jhiAlertService.error(errorMessage, null, null);\r\n    }\r\n\r\n    trackEmployeeById(index: number, item: IEmployee) {\r\n        return item.id;\r\n    }\r\n\r\n    trackOfficeById(index: number, item: IOffice) {\r\n        return item.id;\r\n    }\r\n\r\n    trackProductCategoryById(index: number, item: IProductCategory) {\r\n        return item.id;\r\n    }\r\n\r\n    trackDepartmentById(index: number, item: IDepartment) {\r\n        return item.id;\r\n    }\r\n\r\n    search = (text$: Observable<string>) => {\r\n        const debouncedText$ = text$.pipe(\r\n            debounceTime(200),\r\n            distinctUntilChanged()\r\n        );\r\n        const clicksWithClosedPopup$ = this.click$.pipe(filter(() => !this.instance.isPopupOpen()));\r\n        const inputFocus$ = this.focus$;\r\n\r\n        return merge(debouncedText$, inputFocus$, clicksWithClosedPopup$).pipe(\r\n            map(term =>\r\n                (term === ''\r\n                    ? this.productCategoryNameList\r\n                    : this.productCategoryNameList.filter(v => v.toLowerCase().indexOf(term.toLowerCase()) > -1)\r\n                ).slice(0, 10)\r\n            )\r\n        );\r\n    };\r\n}\r\n"]}]}