{"remainingRequest":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\thread-loader\\dist\\cjs.js??ref--9-2!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\ts-loader\\index.js??ref--9-3!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\angular-router-loader\\src\\index.js!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\tslint-loader\\index.js!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\src\\main\\webapp\\app\\entities\\production-extended\\production-update-extended.component.ts","dependencies":[{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\src\\main\\webapp\\app\\entities\\production-extended\\production-update-extended.component.ts","mtime":1625565387481},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\angular2-template-loader\\index.js","mtime":1486570058000},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\ts-loader\\index.js","mtime":1545640398000},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\angular-router-loader\\src\\index.js","mtime":1512749902000},{"path":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\tslint-loader\\index.js","mtime":1519899048000}],"contextDependencies":[],"result":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\nvar core_1 = require(\"@angular/core\");\r\nvar router_1 = require(\"@angular/router\");\r\nvar ng_jhipster_1 = require(\"ng-jhipster\");\r\nvar production_extended_service_1 = require(\"./production-extended.service\");\r\nvar product_category_1 = require(\"app/entities/product-category\");\r\nvar product_1 = require(\"app/entities/product\");\r\nvar production_1 = require(\"app/entities/production\");\r\nvar shared_1 = require(\"app/shared\");\r\nvar operators_1 = require(\"rxjs/operators\");\r\nvar requisition_details_1 = require(\"app/entities/requisition-details\");\r\nvar requisition_extended_service_1 = require(\"app/entities/requisition-extended/requisition-extended.service\");\r\nvar ProductionUpdateExtendedComponent = /** @class */ (function (_super) {\r\n    tslib_1.__extends(ProductionUpdateExtendedComponent, _super);\r\n    function ProductionUpdateExtendedComponent(jhiAlertService, productionService, productCategoryService, productService, requisitionService, activatedRoute, requisitionDetailsService) {\r\n        var _this = _super.call(this, jhiAlertService, productionService, productCategoryService, productService, requisitionService, activatedRoute) || this;\r\n        _this.jhiAlertService = jhiAlertService;\r\n        _this.productionService = productionService;\r\n        _this.productCategoryService = productCategoryService;\r\n        _this.productService = productService;\r\n        _this.requisitionService = requisitionService;\r\n        _this.activatedRoute = activatedRoute;\r\n        _this.requisitionDetailsService = requisitionDetailsService;\r\n        return _this;\r\n    }\r\n    ProductionUpdateExtendedComponent.prototype.ngOnInit = function () {\r\n        var _this = this;\r\n        this.isSaving = false;\r\n        this.activatedRoute.data.subscribe(function (_a) {\r\n            var production = _a.production;\r\n            _this.production = production;\r\n            _this.createdOn = _this.production.createdOn != null ? _this.production.createdOn.format(shared_1.DATE_TIME_FORMAT) : null;\r\n            _this.updatedOn = _this.production.updatedOn != null ? _this.production.updatedOn.format(shared_1.DATE_TIME_FORMAT) : null;\r\n        });\r\n        this.productCategoryService\r\n            .query()\r\n            .pipe(operators_1.filter(function (mayBeOk) { return mayBeOk.ok; }), operators_1.map(function (response) { return response.body; }))\r\n            .subscribe(function (res) { return (_this.productcategories = res); }, function (res) { return _this.onError(res.message); });\r\n        this.productService\r\n            .query()\r\n            .pipe(operators_1.filter(function (mayBeOk) { return mayBeOk.ok; }), operators_1.map(function (response) { return response.body; }))\r\n            .subscribe(function (res) {\r\n            _this.products = res;\r\n            _this.masterCopyOfProducts = res;\r\n        }, function (res) { return _this.onError(res.message); });\r\n        this.requisitionService\r\n            .query()\r\n            .pipe(operators_1.filter(function (mayBeOk) { return mayBeOk.ok; }), operators_1.map(function (response) { return response.body; }))\r\n            .subscribe(function (res) { return (_this.requisitions = res); }, function (res) { return _this.onError(res.message); });\r\n    };\r\n    ProductionUpdateExtendedComponent.prototype.getRequisitionDetails = function () {\r\n        var _this = this;\r\n        this.requisitionDetailsService\r\n            .query({\r\n            'requisitionId.equals': this.production.requisitionsId\r\n        })\r\n            .pipe(operators_1.filter(function (mayBeOk) { return mayBeOk.ok; }), operators_1.map(function (response) { return response.body; }))\r\n            .subscribe(function (res) {\r\n            _this.requisitionDetails = res;\r\n            _this.setProducts();\r\n        }, function (res) { return _this.onError(res.message); });\r\n    };\r\n    ProductionUpdateExtendedComponent.prototype.setProducts = function () {\r\n        this.products = [];\r\n        for (var i = 0; i < this.masterCopyOfProducts.length; i++) {\r\n            for (var j = 0; j < this.requisitionDetails.length; j++) {\r\n                if (this.masterCopyOfProducts[i].id === this.requisitionDetails[j].productId) {\r\n                    this.products.push(this.masterCopyOfProducts[i]);\r\n                }\r\n            }\r\n        }\r\n        if (this.products) {\r\n            this.production.productsId = this.products[0].id;\r\n            this.getQuantityOfSelectedProduct();\r\n        }\r\n    };\r\n    ProductionUpdateExtendedComponent.prototype.getUnitOfSelectedProduct = function () {\r\n        /*console.log(\"************1213********\");\r\n        for(let i = 0; i < this.requisitionDetails.length; i++) {\r\n            console.log(this.production.productsId + \"===\" + this.requisitionDetails[i].productId);\r\n            if(this.production.productsId === this.requisitionDetails[i].productId) {\r\n                console.log(\"********************\");\r\n                console.log(this.requisitionDetails[i].uom.toString());\r\n            }\r\n        }*/\r\n    };\r\n    ProductionUpdateExtendedComponent.prototype.getQuantityOfSelectedProduct = function () {\r\n        this.getUnitOfSelectedProduct();\r\n        for (var i = 0; i < this.requisitionDetails.length; i++) {\r\n            if (this.production.productsId === this.requisitionDetails[i].productId) {\r\n                this.production.quantity = this.requisitionDetails[i].unit;\r\n                this.maxVal = this.production.quantity;\r\n            }\r\n        }\r\n    };\r\n    ProductionUpdateExtendedComponent.prototype.validateQuantity = function () {\r\n        if (this.production.quantity < 0) {\r\n            this.isSaving = true;\r\n            this.onError('Quantity can not be zero');\r\n        }\r\n        else if (this.production.quantity > this.maxVal && this.production.weightStep === 'RAW') {\r\n            this.isSaving = true;\r\n            this.onError('Quantity can not be bigger than provided in requisition');\r\n        }\r\n        else {\r\n            this.isSaving = false;\r\n        }\r\n    };\r\n    ProductionUpdateExtendedComponent.prototype.validateByProduct = function () {\r\n        if (this.production.byProductQuantity < 0) {\r\n            this.isSaving = true;\r\n            this.onError('By product quantity can not be zero');\r\n        }\r\n        else if (this.production.byProductQuantity > this.maxVal && this.production.weightStep === 'RAW') {\r\n            this.isSaving = true;\r\n            this.onError('By product quantity can not be bigger than provided in requisition');\r\n        }\r\n        else if (this.production.byProductQuantity + this.production.quantity === this.maxVal && this.production.weightStep === 'RAW') {\r\n            this.isSaving = true;\r\n            this.onError('By product quantity and quantity summation should be equal to total value');\r\n        }\r\n        else {\r\n            this.isSaving = false;\r\n        }\r\n    };\r\n    ProductionUpdateExtendedComponent.prototype.setProductCategory = function () {\r\n        var _this = this;\r\n        var selectedRequisition;\r\n        selectedRequisition = this.requisitions.find(function (requisition) { return requisition.id == _this.production.requisitionsId; });\r\n        this.production.productCategoriesId = this.productcategories.find(function (productCategory) { return productCategory.id == selectedRequisition.productCategoryId; }).id;\r\n        this.getRequisitionDetails();\r\n    };\r\n    var _a, _b, _c, _d, _e, _f, _g;\r\n    ProductionUpdateExtendedComponent = tslib_1.__decorate([\r\n        core_1.Component({\r\n            selector: 'jhi-production-update-extended',\r\n            templateUrl: './production-update-extended.component.html'\r\n        }),\r\n        tslib_1.__metadata(\"design:paramtypes\", [typeof (_a = typeof ng_jhipster_1.JhiAlertService !== \"undefined\" && ng_jhipster_1.JhiAlertService) === \"function\" ? _a : Object, typeof (_b = typeof production_extended_service_1.ProductionExtendedService !== \"undefined\" && production_extended_service_1.ProductionExtendedService) === \"function\" ? _b : Object, typeof (_c = typeof product_category_1.ProductCategoryService !== \"undefined\" && product_category_1.ProductCategoryService) === \"function\" ? _c : Object, typeof (_d = typeof product_1.ProductService !== \"undefined\" && product_1.ProductService) === \"function\" ? _d : Object, typeof (_e = typeof requisition_extended_service_1.RequisitionExtendedService !== \"undefined\" && requisition_extended_service_1.RequisitionExtendedService) === \"function\" ? _e : Object, typeof (_f = typeof router_1.ActivatedRoute !== \"undefined\" && router_1.ActivatedRoute) === \"function\" ? _f : Object, typeof (_g = typeof requisition_details_1.RequisitionDetailsService !== \"undefined\" && requisition_details_1.RequisitionDetailsService) === \"function\" ? _g : Object])\r\n    ], ProductionUpdateExtendedComponent);\r\n    return ProductionUpdateExtendedComponent;\r\n}(production_1.ProductionUpdateComponent));\r\nexports.ProductionUpdateExtendedComponent = ProductionUpdateExtendedComponent;\r\n",{"version":3,"file":"C:\\Users\\hp\\Documents\\soptorshi-jhipster\\src\\main\\webapp\\app\\entities\\production-extended\\production-update-extended.component.ts","sourceRoot":"","sources":["C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\angular-router-loader\\src\\index.js!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\node_modules\\tslint-loader\\index.js!C:\\Users\\hp\\Documents\\soptorshi-jhipster\\src\\main\\webapp\\app\\entities\\production-extended\\production-update-extended.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { JhiAlertService } from 'ng-jhipster';\r\nimport { ProductionExtendedService } from './production-extended.service';\r\nimport { ProductCategoryService } from 'app/entities/product-category';\r\nimport { ProductService } from 'app/entities/product';\r\nimport { ProductionUpdateComponent } from 'app/entities/production';\r\nimport { DATE_TIME_FORMAT } from 'app/shared';\r\nimport { filter, map } from 'rxjs/operators';\r\nimport { HttpErrorResponse, HttpResponse } from '@angular/common/http';\r\nimport { IProductCategory } from 'app/shared/model/product-category.model';\r\nimport { IProduct } from 'app/shared/model/product.model';\r\nimport { IRequisition } from 'app/shared/model/requisition.model';\r\nimport { RequisitionDetailsService } from 'app/entities/requisition-details';\r\nimport { IRequisitionDetails } from 'app/shared/model/requisition-details.model';\r\nimport { RequisitionExtendedService } from 'app/entities/requisition-extended/requisition-extended.service';\r\n\r\n@Component({\r\n    selector: 'jhi-production-update-extended',\r\n    templateUrl: './production-update-extended.component.html'\r\n})\r\nexport class ProductionUpdateExtendedComponent extends ProductionUpdateComponent {\r\n    requisitionDetails: IRequisitionDetails[];\r\n    masterCopyOfProducts: IProduct[];\r\n\r\n    maxVal: number;\r\n\r\n    constructor(\r\n        protected jhiAlertService: JhiAlertService,\r\n        protected productionService: ProductionExtendedService,\r\n        protected productCategoryService: ProductCategoryService,\r\n        protected productService: ProductService,\r\n        protected requisitionService: RequisitionExtendedService,\r\n        protected activatedRoute: ActivatedRoute,\r\n        protected requisitionDetailsService: RequisitionDetailsService\r\n    ) {\r\n        super(jhiAlertService, productionService, productCategoryService, productService, requisitionService, activatedRoute);\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.isSaving = false;\r\n        this.activatedRoute.data.subscribe(({ production }) => {\r\n            this.production = production;\r\n            this.createdOn = this.production.createdOn != null ? this.production.createdOn.format(DATE_TIME_FORMAT) : null;\r\n            this.updatedOn = this.production.updatedOn != null ? this.production.updatedOn.format(DATE_TIME_FORMAT) : null;\r\n        });\r\n        this.productCategoryService\r\n            .query()\r\n            .pipe(\r\n                filter((mayBeOk: HttpResponse<IProductCategory[]>) => mayBeOk.ok),\r\n                map((response: HttpResponse<IProductCategory[]>) => response.body)\r\n            )\r\n            .subscribe((res: IProductCategory[]) => (this.productcategories = res), (res: HttpErrorResponse) => this.onError(res.message));\r\n        this.productService\r\n            .query()\r\n            .pipe(\r\n                filter((mayBeOk: HttpResponse<IProduct[]>) => mayBeOk.ok),\r\n                map((response: HttpResponse<IProduct[]>) => response.body)\r\n            )\r\n            .subscribe(\r\n                (res: IProduct[]) => {\r\n                    this.products = res;\r\n                    this.masterCopyOfProducts = res;\r\n                },\r\n                (res: HttpErrorResponse) => this.onError(res.message)\r\n            );\r\n        this.requisitionService\r\n            .query()\r\n            .pipe(\r\n                filter((mayBeOk: HttpResponse<IRequisition[]>) => mayBeOk.ok),\r\n                map((response: HttpResponse<IRequisition[]>) => response.body)\r\n            )\r\n            .subscribe((res: IRequisition[]) => (this.requisitions = res), (res: HttpErrorResponse) => this.onError(res.message));\r\n    }\r\n\r\n    getRequisitionDetails() {\r\n        this.requisitionDetailsService\r\n            .query({\r\n                'requisitionId.equals': this.production.requisitionsId\r\n            })\r\n            .pipe(\r\n                filter((mayBeOk: HttpResponse<IRequisitionDetails[]>) => mayBeOk.ok),\r\n                map((response: HttpResponse<IRequisitionDetails[]>) => response.body)\r\n            )\r\n            .subscribe(\r\n                (res: IRequisitionDetails[]) => {\r\n                    this.requisitionDetails = res;\r\n                    this.setProducts();\r\n                },\r\n                (res: HttpErrorResponse) => this.onError(res.message)\r\n            );\r\n    }\r\n\r\n    setProducts() {\r\n        this.products = [];\r\n        for (let i = 0; i < this.masterCopyOfProducts.length; i++) {\r\n            for (let j = 0; j < this.requisitionDetails.length; j++) {\r\n                if (this.masterCopyOfProducts[i].id === this.requisitionDetails[j].productId) {\r\n                    this.products.push(this.masterCopyOfProducts[i]);\r\n                }\r\n            }\r\n        }\r\n        if (this.products) {\r\n            this.production.productsId = this.products[0].id;\r\n            this.getQuantityOfSelectedProduct();\r\n        }\r\n    }\r\n\r\n    getUnitOfSelectedProduct() {\r\n        /*console.log(\"************1213********\");\r\n        for(let i = 0; i < this.requisitionDetails.length; i++) {\r\n            console.log(this.production.productsId + \"===\" + this.requisitionDetails[i].productId);\r\n            if(this.production.productsId === this.requisitionDetails[i].productId) {\r\n                console.log(\"********************\");\r\n                console.log(this.requisitionDetails[i].uom.toString());\r\n            }\r\n        }*/\r\n    }\r\n\r\n    getQuantityOfSelectedProduct() {\r\n        this.getUnitOfSelectedProduct();\r\n        for (let i = 0; i < this.requisitionDetails.length; i++) {\r\n            if (this.production.productsId === this.requisitionDetails[i].productId) {\r\n                this.production.quantity = this.requisitionDetails[i].unit;\r\n                this.maxVal = this.production.quantity;\r\n            }\r\n        }\r\n    }\r\n\r\n    validateQuantity() {\r\n        if (this.production.quantity < 0) {\r\n            this.isSaving = true;\r\n            this.onError('Quantity can not be zero');\r\n        } else if (this.production.quantity > this.maxVal && this.production.weightStep === 'RAW') {\r\n            this.isSaving = true;\r\n            this.onError('Quantity can not be bigger than provided in requisition');\r\n        } else {\r\n            this.isSaving = false;\r\n        }\r\n    }\r\n\r\n    validateByProduct() {\r\n        if (this.production.byProductQuantity < 0) {\r\n            this.isSaving = true;\r\n            this.onError('By product quantity can not be zero');\r\n        } else if (this.production.byProductQuantity > this.maxVal && this.production.weightStep === 'RAW') {\r\n            this.isSaving = true;\r\n            this.onError('By product quantity can not be bigger than provided in requisition');\r\n        } else if (this.production.byProductQuantity + this.production.quantity === this.maxVal && this.production.weightStep === 'RAW') {\r\n            this.isSaving = true;\r\n            this.onError('By product quantity and quantity summation should be equal to total value');\r\n        } else {\r\n            this.isSaving = false;\r\n        }\r\n    }\r\n\r\n    setProductCategory() {\r\n        let selectedRequisition: IRequisition;\r\n        selectedRequisition = this.requisitions.find(requisition => requisition.id == this.production.requisitionsId);\r\n        this.production.productCategoriesId = this.productcategories.find(\r\n            productCategory => productCategory.id == selectedRequisition.productCategoryId\r\n        ).id;\r\n        this.getRequisitionDetails();\r\n    }\r\n}\r\n"]}]}